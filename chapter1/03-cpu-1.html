
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>上下文切换 · Linux实用手册</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-atoc/atoc.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="03-cpu-2.html" />
    
    
    <link rel="prev" href="03-cpu.html" />
    

    <!--Google ads -->
    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <script>
      (adsbygoogle = window.adsbygoogle || []).push({
        google_ad_client: "ca-pub-8176866190626448",
        enable_page_level_ads: true
      });
    </script>
    
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-105389858-1"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-105389858-1');
    </script>
    
    <!--百度统计-->
    <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?8f59ea10145df28da8932c8743ec1d60";
      var s = document.getElementsByTagName("script")[0]; 
      s.parentNode.insertBefore(hm, s);
    })();
    </script>
    
    <!--百度收录-->
    <script>
    (function(){
        var bp = document.createElement('script');
        var curProtocol = window.location.protocol.split(':')[0];
        if (curProtocol === 'https') {
            bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
        }
        else {
            bp.src = 'http://push.zhanzhang.baidu.com/push.js';
        }
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(bp, s);
    })();
    </script>
    <style type="text/css">
    .book.color-theme-1 .book-body .page-wrapper .page-inner section.normal a {color: #4183c4;}
    </style>
    </head>
    <body>
        
<div class="book color-theme-1">
    <div class="book-summary">
        
            
            
                
<div style="height:150px;text-align:center">
	<h2>记住网址&nbsp;<a href="https://www.lijiaocn.com " style="color:#afa790">www.lijiaocn.com</a></h2>
</div>


                <nav role="navigation">
                


<ul class="summary">
	<li><a href="https://www.lijiaocn.com">博客首页</a></li>
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                    关于这本书
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="./">
            
                <a href="./">
            
                    
                    Linux性能优化
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1" data-path="01-concept.html">
            
                <a href="01-concept.html">
            
                    
                    建立概念
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2" data-path="02-process.html">
            
                <a href="02-process.html">
            
                    
                    理解进程
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.2.1" data-path="02-process-1.html">
            
                <a href="02-process-1.html">
            
                    
                    进程的分类
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2.2" data-path="02-process-2.html">
            
                <a href="02-process-2.html">
            
                    
                    进程的状态
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2.3" data-path="02-process-3.html">
            
                <a href="02-process-3.html">
            
                    
                    用户态与内核态
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.2.3" data-path="03-cpu.html">
            
                <a href="03-cpu.html">
            
                    
                    理解CPU
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter active" data-level="1.2.3.1" data-path="03-cpu-1.html">
            
                <a href="03-cpu-1.html">
            
                    
                    上下文切换
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.3.2" data-path="03-cpu-2.html">
            
                <a href="03-cpu-2.html">
            
                    
                    CPU使用率
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.2.4" data-path="04-tool.html">
            
                <a href="04-tool.html">
            
                    
                    分析工具
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.4.1" data-path="04-flame-graphs.html">
            
                <a href="04-flame-graphs.html">
            
                    
                    火焰图介绍
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.4.1.1" data-path="04-flame-graphs-cpu.html">
            
                <a href="04-flame-graphs-cpu.html">
            
                    
                    CPU火焰图
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.4.1.2" data-path="04-flame-graphs-memory.html">
            
                <a href="04-flame-graphs-memory.html">
            
                    
                    内存火焰图
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.4.1.3" data-path="04-flame-graphs-off-cpu.html">
            
                <a href="04-flame-graphs-off-cpu.html">
            
                    
                    Off-CPU火焰图
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.4.1.4" data-path="04-flame-graphs-hot-code.html">
            
                <a href="04-flame-graphs-hot-code.html">
            
                    
                    冷热火焰图
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.4.1.5" data-path="04-flame-graphs-differential.html">
            
                <a href="04-flame-graphs-differential.html">
            
                    
                    差异火焰图
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.4.1.6" data-path="04-flame-generate.html">
            
                <a href="04-flame-generate.html">
            
                    
                    火焰图生成
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="../chapter2/">
            
                <a href="../chapter2/">
            
                    
                    Linux系统工具
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1" data-path="../chapter2/01-network.html">
            
                <a href="../chapter2/01-network.html">
            
                    
                    网络诊断
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1.1" data-path="../chapter2/01-network-ss.html">
            
                <a href="../chapter2/01-network-ss.html">
            
                    
                    ss
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3.2" data-path="../chapter2/02-performance.html">
            
                <a href="../chapter2/02-performance.html">
            
                    
                    性能诊断
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="../chapter3/">
            
                <a href="../chapter3/">
            
                    
                    Linux系统知识
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" data-path="../chapter3/01-filesystem.html">
            
                <a href="../chapter3/01-filesystem.html">
            
                    
                    文件系统
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="../chapter4/">
            
                <a href="../chapter4/">
            
                    
                    Linux虚拟化技术
            
                </a>
            

            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
                
<div style="text-align:center">
<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- Summary_Bottom -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-8176866190626448"
     data-ad-slot="2156601384"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
</div>


            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >上下文切换</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
                                <section class="normal markdown-section">
                                
                                
<!-- Page_Top -->
<!--div>
<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-8176866190626448"
     data-ad-slot="5702052586"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
</div-->


                                <!-- toc -->
<ul>
<li><a href="#cpu&#x8FD0;&#x884C;&#x4E0A;&#x4E0B;&#x6587;&#x7684;&#x5207;&#x6362;">CPU&#x8FD0;&#x884C;&#x4E0A;&#x4E0B;&#x6587;&#x7684;&#x5207;&#x6362;</a><ul>
<li><a href="#&#x7279;&#x6743;&#x6A21;&#x5F0F;&#x5207;&#x6362;">&#x7279;&#x6743;&#x6A21;&#x5F0F;&#x5207;&#x6362;</a></li>
<li><a href="#&#x8FDB;&#x7A0B;&#x4E0A;&#x4E0B;&#x6587;&#x5207;&#x6362;">&#x8FDB;&#x7A0B;&#x4E0A;&#x4E0B;&#x6587;&#x5207;&#x6362;</a></li>
<li><a href="#&#x7EBF;&#x7A0B;&#x4E0A;&#x4E0B;&#x6587;&#x5207;&#x6362;">&#x7EBF;&#x7A0B;&#x4E0A;&#x4E0B;&#x6587;&#x5207;&#x6362;</a></li>
<li><a href="#&#x4E2D;&#x65AD;&#x4E0A;&#x4E0B;&#x6587;&#x5207;&#x6362;">&#x4E2D;&#x65AD;&#x4E0A;&#x4E0B;&#x6587;&#x5207;&#x6362;</a></li>
<li><a href="#&#x7528;vmstat&#x67E5;&#x770B;&#x4E0A;&#x4E0B;&#x6587;&#x5207;&#x6362;">&#x7528;vmstat&#x67E5;&#x770B;&#x4E0A;&#x4E0B;&#x6587;&#x5207;&#x6362;</a></li>
<li><a href="#&#x7528;pidstat&#x67E5;&#x770B;&#x7279;&#x5B9A;&#x8FDB;&#x7A0B;&#x7684;&#x5207;&#x6362;&#x60C5;&#x51B5;">&#x7528;pidstat&#x67E5;&#x770B;&#x7279;&#x5B9A;&#x8FDB;&#x7A0B;&#x7684;&#x5207;&#x6362;&#x60C5;&#x51B5;</a></li>
<li><a href="#&#x4ECE;procinterrupts&#x8BFB;&#x53D6;&#x4E2D;&#x65AD;&#x72B6;&#x6001;">&#x4ECE;/proc/interrupts&#x8BFB;&#x53D6;&#x4E2D;&#x65AD;&#x72B6;&#x6001;</a></li>
</ul>
</li>
</ul>
<!-- tocstop -->
<h1 id="cpu&#x8FD0;&#x884C;&#x4E0A;&#x4E0B;&#x6587;&#x7684;&#x5207;&#x6362;">CPU&#x8FD0;&#x884C;&#x4E0A;&#x4E0B;&#x6587;&#x7684;&#x5207;&#x6362;</h1>
<p>CPU&#x7684;&#x4E0A;&#x4E0B;&#x6587;&#x5207;&#x6362;&#x53D1;&#x751F;&#x5728;&#x8FD9;&#x51E0;&#x4E2A;&#x573A;&#x666F;&#x4E2D;&#xFF1A;&#x7279;&#x6743;&#x6A21;&#x5F0F;&#x5207;&#x6362;&#x3001;&#x8FDB;&#x7A0B;&#x4E0A;&#x4E0B;&#x6587;&#x5207;&#x6362;&#x3001;&#x7EBF;&#x7A0B;&#x4E0A;&#x4E0B;&#x6587;&#x5207;&#x6362;&#x3001;&#x4E2D;&#x65AD;&#x4E0A;&#x4E0B;&#x6587;&#x5207;&#x6362;&#x3002;</p>
<h2 id="&#x7279;&#x6743;&#x6A21;&#x5F0F;&#x5207;&#x6362;">&#x7279;&#x6743;&#x6A21;&#x5F0F;&#x5207;&#x6362;</h2>
<p>&#x5728;Linux&#x4E2D;&#xFF0C;&#x7279;&#x6743;&#x6A21;&#x5F0F;&#x5207;&#x6362;&#x4E5F;&#x5C31;&#x662F;&#x7528;&#x6237;&#x6001;&#x548C;&#x5185;&#x6838;&#x6001;&#x7684;&#x5207;&#x6362;&#xFF0C;&#x4E00;&#x4E2A;&#x7528;&#x6237;&#x6001;&#x8FDB;&#x7A0B;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x8C03;&#x7528;&#x5185;&#x6838;&#x63D0;&#x4F9B;&#x7684;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x8FDB;&#x5165;&#x5230;&#x5185;&#x6838;&#x6001;&#xFF0C;&#x8FD9;&#x4E2A;&#x8FC7;&#x7A0B;&#x4E2D;&#x6709;&#x4E00;&#x4E9B;&#x7279;&#x6B8A;&#x7684;CPU&#x6307;&#x4EE4;&#x4F1A;&#x88AB;&#x6267;&#x884C;&#xFF0C;&#x5C06;CPU&#x5207;&#x6362;&#x7279;&#x6743;&#x6A21;&#x5F0F;&#x3002;</p>
<p>&#x7279;&#x6743;&#x7684;&#x6A21;&#x5F0F;&#x7684;&#x5207;&#x6362;&#xFF0C;&#x4E00;&#x822C;&#x662F;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#xFF0C;&#x901A;&#x5E38;&#x662F;&#x4E00;&#x53BB;&#x4E00;&#x56DE;&#xFF0C;&#x4F34;&#x968F;&#x7740;&#x4E24;&#x6B21;&#x4E0A;&#x4E0B;&#x6587;&#x5207;&#x6362;&#x3002;</p>
<p>&#x8C03;&#x7528;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x65F6;&#x5019;&#xFF0C;&#x9700;&#x8981;&#x4FDD;&#x5B58;&#x8FDB;&#x7A0B;&#x5728;&#x7528;&#x6237;&#x6001;&#x7684;&#x5F53;&#x524D;&#x72B6;&#x6001;&#xFF0C;&#x7136;&#x540E;&#x5207;&#x6362;&#x5230;&#x5185;&#x6838;&#x6001;&#x4EE3;&#x7801;&#xFF0C;&#x8FD9;&#x662F;&#x7B2C;&#x4E00;&#x6B21;&#x4E0A;&#x4E0B;&#x6587;&#x5207;&#x6362;&#x3002;</p>
<p>&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x6267;&#x884C;&#x7ED3;&#x675F;&#x540E;&#xFF0C;CPU&#x9000;&#x51FA;&#x7279;&#x6743;&#x6A21;&#x5F0F;&#xFF0C;&#x52A0;&#x8F7D;&#x4E4B;&#x524D;&#x4FDD;&#x7559;&#x7684;&#x7528;&#x6237;&#x6001;&#x7684;&#x72B6;&#x6001;&#xFF0C;&#x8FD9;&#x662F;&#x7B2C;&#x4E8C;&#x6B21;&#x4E0A;&#x4E0B;&#x6587;&#x5207;&#x6362;&#x3002;</p>
<h2 id="&#x8FDB;&#x7A0B;&#x4E0A;&#x4E0B;&#x6587;&#x5207;&#x6362;">&#x8FDB;&#x7A0B;&#x4E0A;&#x4E0B;&#x6587;&#x5207;&#x6362;</h2>
<p>&#x8FDB;&#x7A0B;&#x662F;&#x5185;&#x6838;&#x7BA1;&#x7406;&#x8C03;&#x5EA6;&#x7684;&#xFF0C;&#x662F;&#x5728;&#x5185;&#x6838;&#x6001;&#x8FDB;&#x884C;&#x5207;&#x6362;&#x7684;&#x3002;</p>
<p>&#x8FDB;&#x7A0B;&#x4E0A;&#x4E0B;&#x6587;&#x5207;&#x6362;&#x65F6;&#xFF0C;&#x9700;&#x8981;&#x4FDD;&#x7559;&#x5F53;&#x524D;&#x8FDB;&#x7A0B;&#x7684;&#x72B6;&#x6001;&#xFF0C;&#x7136;&#x540E;&#x52A0;&#x8F7D;&#x4E0B;&#x4E00;&#x4E2A;&#x7EE7;&#x627F;&#x7684;&#x72B6;&#x6001;&#xFF0C;&#x6BCF;&#x6B21;&#x5207;&#x6362;&#x9700;&#x8981;&#x51E0;&#x5341;&#x7EB3;&#x79D2;&#x5230;&#x51E0;&#x5FAE;&#x5999;&#x7684;&#x65F6;&#x95F4;&#xFF0C;&#x662F;&#x4E00;&#x4E2A;&#x5F00;&#x9500;&#x975E;&#x5E38;&#x5927;&#x64CD;&#x4F5C;&#x3002;</p>
<p>&#x8FDB;&#x7A0B;&#x4E0A;&#x4E0B;&#x6587;&#x5207;&#x6362;&#x540E;&#xFF0C;&#x4E00;&#x4E9B;&#x5B58;&#x5728;&#x786C;&#x4EF6;&#x5BC4;&#x5B58;&#x5668;&#x7684;&#x7F13;&#x5B58;&#x9700;&#x8981;&#x88AB;&#x91CD;&#x65B0;&#x5237;&#x65B0;&#xFF0C;&#x4E5F;&#x4F7F;&#x6267;&#x884C;&#x6548;&#x7387;&#x53D7;&#x5230;&#x5F71;&#x54CD;&#x3002;&#x5728;&#x591A;&#x6838;&#x7684;&#x673A;&#x5668;&#xFF0C;&#x8FDB;&#x7A0B;&#x8FD8;&#x53EF;&#x80FD;&#x5728;&#x4E0D;&#x540C;CPU&#x6838;&#x5FC3;&#x4E0A;&#x79FB;&#x52A8;&#xFF0C;&#x4E5F;&#x4F1A;&#x5E26;&#x6765;&#x989D;&#x5916;&#x7684;&#x5F00;&#x9500;&#x3002;</p>
<p>&#x8FDB;&#x7A0B;&#x4E0A;&#x4E0B;&#x6587;&#x5207;&#x6362;&#x662F;&#x4E00;&#x822C;&#x4E0D;&#x53EF;&#x907F;&#x514D;&#x7684;&#xFF0C;&#x56E0;&#x4E3A;&#x5728;&#x4E00;&#x4E2A;&#x901A;&#x7528;&#x7684;Linux&#x7CFB;&#x7EDF;&#x4E0A;&#xFF0C;&#x8FDB;&#x7A0B;&#x7684;&#x6570;&#x91CF;&#x4E00;&#x5B9A;&#x662F;&#x8FDC;&#x8FDC;&#x8D85;&#x8FC7;CPU&#x6838;&#x5FC3;&#x6570;&#x7684;&#x3002;&#x5982;&#x679C;&#x4E00;&#x4E2A;&#x4E3B;&#x8981;&#x7684;&#x5DE5;&#x4F5C;&#x8FDB;&#x7A0B;&#x56E0;&#x4E3A;&#x88AB;&#x9891;&#x7E41;&#x5730;&#x5207;&#x6362;&#x4E0A;&#x4E0B;&#x6587;&#xFF0C;&#x5BFC;&#x81F4;&#x6548;&#x7387;&#x4E0D;&#x9AD8;&#xFF0C;&#x53EF;&#x4EE5;&#x5C06;&#x8FDB;&#x7A0B;&#x7ED1;&#x5B9A;&#x6307;&#x5B9A;CPU&#x6838;&#x5FC3;&#x4E0A;&#x3002;</p>
<h2 id="&#x7EBF;&#x7A0B;&#x4E0A;&#x4E0B;&#x6587;&#x5207;&#x6362;">&#x7EBF;&#x7A0B;&#x4E0A;&#x4E0B;&#x6587;&#x5207;&#x6362;</h2>
<p>&#x8FDB;&#x7A0B;&#x662F;&#x8D44;&#x6E90;&#x62E5;&#x6709;&#x7684;&#x57FA;&#x672C;&#x5355;&#x4F4D;&#xFF0C;&#x7EBF;&#x7A0B;&#x662F;&#x8C03;&#x5EA6;&#x7684;&#x57FA;&#x672C;&#x5355;&#x4F4D;&#x3002;&#x4E00;&#x4E2A;&#x8FDB;&#x7A0B;&#x5BF9;&#x5E94;&#x81F3;&#x5C11;&#x4E00;&#x4E2A;&#x7EBF;&#x7A0B;&#xFF0C;&#x53EF;&#x4EE5;&#x5BF9;&#x5E94;&#x591A;&#x4E2A;&#x7EBF;&#x7A0B;&#x3002;</p>
<p>&#x96B6;&#x5C5E;&#x4E8E;&#x540C;&#x4E00;&#x4E2A;&#x7EE7;&#x627F;&#x7684;&#x7EBF;&#x7A0B;&#x95F4;&#x8FDB;&#x884C;&#x4E0A;&#x4E0B;&#x6587;&#x5207;&#x6362;&#x7684;&#x5F00;&#x9500;&#x76F8;&#x5BF9;&#x8F83;&#x5C0F;&#xFF0C;&#x56E0;&#x4E3A;&#x5B83;&#x4EEC;&#x6709;&#x4E00;&#x90E8;&#x5206;&#x5171;&#x7528;&#x7684;&#x6570;&#x636E;&#xFF0C;&#x8FD9;&#x4E9B;&#x6570;&#x636E;&#x53EF;&#x4EE5;&#x514D;&#x9664;&#x5207;&#x6362;&#x3002;</p>
<h2 id="&#x4E2D;&#x65AD;&#x4E0A;&#x4E0B;&#x6587;&#x5207;&#x6362;">&#x4E2D;&#x65AD;&#x4E0A;&#x4E0B;&#x6587;&#x5207;&#x6362;</h2>
<p>&#x4E2D;&#x65AD;&#x901A;&#x5E38;&#x662F;&#x786C;&#x4EF6;&#x53D1;&#x51FA;&#x7684;&#xFF0C;&#x4E5F;&#x53EF;&#x4EE5;&#x7528;&#x5B9E;&#x73B0;&#x201C;&#x8F6F;&#x4E2D;&#x65AD;&#x201D;&#xFF0C;&#x4E2D;&#x65AD;&#x53D1;&#x751F;&#x540E;&#xFF0C;CPU&#x901A;&#x5E38;&#x9700;&#x8981;&#x505C;&#x4E0B;&#x5F53;&#x524D;&#x7684;&#x5DE5;&#x4F5C;&#xFF0C;&#x4F18;&#x5148;&#x5904;&#x7406;&#x4E2D;&#x65AD;&#x5B9E;&#x73B0;&#xFF0C;&#x6307;&#x5B9A;&#x4E2D;&#x65AD;&#x4E8B;&#x4EF6;&#x5BF9;&#x5E94;&#x7684;&#x6307;&#x4EE4;&#x3002;</p>
<p>&#x4E2D;&#x65AD;&#x53EA;&#x53D1;&#x751F;&#x5728;&#x5185;&#x6838;&#x6001;&#x3002;</p>
<p>&#x4E2D;&#x65AD;&#x4F1A;&#x6253;&#x65AD;&#x5176;&#x5B83;&#x8FDB;&#x7A0B;&#x7684;&#x8C03;&#x5EA6;&#x548C;&#x6267;&#x884C;&#xFF0C;&#x5E26;&#x6765;&#x989D;&#x5916;&#x7684;&#x5F00;&#x9500;&#xFF0C;&#x5982;&#x679C;&#x4E2D;&#x65AD;&#x6B21;&#x6570;&#x8FC7;&#x591A;&#xFF0C;&#x4F1A;&#x663E;&#x8457;&#x964D;&#x4F4E;&#x6574;&#x4F53;&#x7CFB;&#x7EDF;&#x3002;</p>
<h2 id="&#x7528;vmstat&#x67E5;&#x770B;&#x4E0A;&#x4E0B;&#x6587;&#x5207;&#x6362;">&#x7528;vmstat&#x67E5;&#x770B;&#x4E0A;&#x4E0B;&#x6587;&#x5207;&#x6362;</h2>
<p><code>vmstat</code>&#x547D;&#x4EE4;&#x663E;&#x793A;&#x7CFB;&#x7EDF;&#x6574;&#x4F53;&#x72B6;&#x6001;&#xFF0C;&#x8F93;&#x51FA;&#x5982;&#x4E0B;&#xFF1A;</p>
<pre><code class="lang-bash">$ vmstat
procs -----------memory---------- ---swap-- -----io---- -system-- ------cpu-----
 r  b   swpd   free   buff  cache   si   so    bi    bo   <span class="hljs-keyword">in</span>   cs us sy id wa st
 1  0   5980 126076    648 6997448    0    0     6    27   13    1  1  1 97  0  0
</code></pre>
<p>&#x53EF;&#x4EE5;&#x5728;&#x540E;&#x9762;&#x52A0;&#x4E0A;&#x4E00;&#x4E2A;&#x6570;&#x5B57;&#xFF0C;&#x6BCF;&#x9694;&#x6307;&#x5B9A;&#x65F6;&#x95F4;&#x8F93;&#x51FA;&#x4E00;&#x6B21;&#xFF0C;&#x4F8B;&#x5982;<code>vmstat 5</code>&#xFF0C;&#x5982;&#x679C;&#x611F;&#x89C9;&#x6570;&#x636E;&#x6392;&#x5217;&#x592A;&#x5BC6;&#x96C6;&#xFF0C;&#x53EF;&#x4EE5;&#x52A0;&#x4E0A;&#x53C2;&#x6570;<code>-w</code>&#xFF0C;&#x7528;&#x5BBD;&#x683C;&#x5F0F;&#x663E;&#x793A;&#x3002;</p>
<p>vmstat&#x547D;&#x4EE4;&#x7684;&#x8F93;&#x51FA;&#x5305;&#x542B;<code>procs</code>&#x3001;<code>memory</code>&#x3001; <code>swap</code>&#x3001;<code>io</code>&#x3001;<code>system</code>&#x548C;<code>cpu</code>&#x516D;&#x5757;&#x5185;&#x5BB9;&#x3002;</p>
<p>&#x6BCF;&#x5217;&#x6570;&#x636E;&#x7684;&#x542B;&#x4E49;&#x5982;&#x4E0B;&#xFF0C;&#x53EF;&#x4EE5;&#x5728;<code>man vmstat</code>&#x4E2D;&#x627E;&#x5230;&#xFF1A;</p>
<pre><code>Procs
    r: The number of runnable processes (running or waiting for run time).
    b: The number of processes in uninterruptible sleep.

Memory
    swpd: the amount of virtual memory used.
    free: the amount of idle memory.
    buff: the amount of memory used as buffers.
    cache: the amount of memory used as cache.
    inact: the amount of inactive memory.  (-a option)
    active: the amount of active memory.  (-a option)

Swap
    si: Amount of memory swapped in from disk (/s).
    so: Amount of memory swapped to disk (/s).

IO
    bi: Blocks received from a block device (blocks/s).
    bo: Blocks sent to a block device (blocks/s).

System
    in: The number of interrupts per second, including the clock.
    cs: The number of context switches per second.

CPU
    These are percentages of total CPU time.
    us: Time spent running non-kernel code.  (user time, including nice time)
    sy: Time spent running kernel code.  (system time)
    id: Time spent idle.  Prior to Linux 2.5.41, this includes IO-wait time.
    wa: Time spent waiting for IO.  Prior to Linux 2.5.41, included in idle.
    st: Time stolen from a virtual machine.  Prior to Linux 2.6.11, unknown.
</code></pre><p>&#x5176;&#x4E2D;<code>cs</code>&#x662F;&#x4E00;&#x79D2;&#x5185;&#x53D1;&#x751F;&#x7684;&#x4E0A;&#x4E0B;&#x6587;&#x5207;&#x6362;&#x6B21;&#x6570;&#x3002;</p>
<h2 id="&#x7528;pidstat&#x67E5;&#x770B;&#x7279;&#x5B9A;&#x8FDB;&#x7A0B;&#x7684;&#x5207;&#x6362;&#x60C5;&#x51B5;">&#x7528;pidstat&#x67E5;&#x770B;&#x7279;&#x5B9A;&#x8FDB;&#x7A0B;&#x7684;&#x5207;&#x6362;&#x60C5;&#x51B5;</h2>
<p><code>pidstat -w</code>&#x53EF;&#x4EE5;&#x663E;&#x793A;&#x6BCF;&#x4E2A;&#x8FDB;&#x7A0B;&#x7684;&#x4E0A;&#x4E0B;&#x6587;&#x5207;&#x6362;&#x60C5;&#x51B5;&#xFF1A;</p>
<pre><code class="lang-bash">$ pidstat -w
Linux 3.10.0-693.11.6.el7.x86_64 (10.10.64.58)     12/04/2018     _x86_64_    (4 CPU)

04:04:15 PM   UID       PID   cswch/s nvcswch/s  Command
04:04:15 PM     0         1      1.75      0.00  systemd
04:04:15 PM     0         2      0.01      0.00  kthreadd
04:04:15 PM     0         3      2.54      0.00  ksoftirqd/0
...&#x7701;&#x7565;&#x540E;&#x7EED;&#x5185;&#x5BB9;...
</code></pre>
<p>&#xFF08;&#x53EF;&#x4EE5;&#x5728;&#x540E;&#x9762;&#x4E0A;&#x4E00;&#x4E2A;&#x6570;&#x5B57;&#xFF0C;&#x6BCF;&#x9694;&#x6307;&#x5B9A;&#x65F6;&#x95F4;&#x8F93;&#x51FA;&#x4E00;&#x6B21;&#xFF0C;&#x4F8B;&#x5982;<code>pidstat -w 5</code>&#xFF09;</p>
<p>&#x7279;&#x522B;&#x6CE8;&#x610F;&#xFF1A;pidstats -w&#x663E;&#x793A;&#x7684;&#x662F;&#x8FDB;&#x7A0B;&#x7684;&#x72B6;&#x6001;&#xFF0C;&#x5982;&#x679C;&#x8981;&#x5C06;&#x7EBF;&#x7A0B;&#x4E00;&#x5E76;&#x663E;&#x793A;&#x51FA;&#x6765;&#xFF0C;&#x9700;&#x8981;&#x518D;&#x52A0;&#x4E00;&#x4E2A;-t&#x53C2;&#x6570;&#xFF1A;</p>
<pre><code class="lang-bash">$ pidstat -wt
Average:      UID      TGID       TID   cswch/s nvcswch/s  Command
Average:        0         3         -      3.92      0.00  ksoftirqd/0
Average:        0         -         3      3.92      0.00  |__ksoftirqd/0
Average:        0         9         -     45.59      0.00  rcu_<span class="hljs-built_in">sched</span>
Average:        0         -         9     45.59      0.00  |__rcu_<span class="hljs-built_in">sched</span>
Average:        0        13         -      1.96      0.00  ksoftirqd/1
Average:        0         -        13      1.96      0.00  |__ksoftirqd/1
Average:        0        17         -      0.49      0.00  migration/2
...&#x7701;&#x7565;&#x540E;&#x7EED;&#x5185;&#x5BB9;...
</code></pre>
<p><code>-w</code>&#x53C2;&#x6570;&#x7684;&#x4F5C;&#x7528;&#x662F;&#x663E;&#x793A;&#x8FDB;&#x7A0B;&#x5207;&#x6362;&#x72B6;&#x6001;&#xFF0C;&#x6BCF;&#x4E00;&#x5217;&#x7684;&#x542B;&#x4E49;&#x5982;&#x4E0B;&#xFF08;&#x53EF;&#x4EE5;&#x5728;<code>man pidstat</code>&#x4E2D;&#x627E;&#x5230;&#xFF09;&#xFF1A;</p>
<pre><code> -w     Report task switching activity (kernels 2.6.23 and later only).  
        The following values may be displayed:
  UID
         The real user identification number of the task being monitored.

  USER
         The name of the real user owning the task being monitored.

  PID
         The identification number of the task being monitored.

  cswch/s
         Total number of voluntary context switches the task made per second.  
         A voluntary context switch occurs when a task blocks because it requires 
         a resource that is unavailable.

  nvcswch/s
         Total number of non voluntary context switches the task made per second.  
         A involuntary context switch takes place when a task executes for the duration 
         of its  time  slice  and then is forced to relinquish the processor.

  Command
         The command name of the task.
</code></pre><p>&#x9700;&#x8981;&#x6CE8;&#x610F;&#x81EA;&#x613F;&#x5207;&#x6362;&#xFF08;cswch/s&#xFF0C;voluntary context switches&#xFF09;&#x548C;&#x975E;&#x81EA;&#x613F;&#x5207;&#x6362;&#xFF08;nvcswch/s&#xFF0C;non voluntary context switches&#xFF09;&#x7684;&#x533A;&#x522B;&#x3002;&#x524D;&#x8005;&#x662F;&#x56E0;&#x4E3A;&#x9700;&#x8981;&#x7684;&#x8D44;&#x6E90;&#x6CA1;&#x6709;&#x51C6;&#x5907;&#x597D;&#xFF0C;&#x4E3B;&#x52A8;&#x8BA9;&#x51FA;CPU&#x53D1;&#x751F;&#x7684;&#x5207;&#x6362;&#xFF0C;&#x540E;&#x8005;&#x662F;&#x8FDB;&#x7A0B;&#x5206;&#x914D;&#x7684;&#x65F6;&#x95F4;&#x7247;&#x5DF2;&#x7ECF;&#x7528;&#x5B8C;&#xFF0C;&#x88AB;&#x8C03;&#x5EA6;&#x5668;&#x5F3A;&#x5236;&#x5207;&#x6362;&#x3002;</p>
<p>&#x53E6;&#x5916;pidstat&#x8FD8;&#x6709;&#x4E00;&#x4E2A;<code>-u</code>&#x53C2;&#x6570;&#xFF0C;&#x53EF;&#x4EE5;&#x4E00;&#x5E76;&#x8F93;&#x51FA;&#x8FDB;&#x7A0B;&#x548C;&#x7EBF;&#x7A0B;&#xFF08;&#x52A0;-t&#xFF09;&#x7684;CPU&#x4F7F;&#x7528;&#x60C5;&#x51B5;&#xFF1A;</p>
<pre><code class="lang-bash">[root@10.10.64.58 ~]<span class="hljs-comment">#  pidstat -wt -u</span>
Linux 3.10.0-693.11.6.el7.x86_64 (10.10.64.58)     12/04/2018     _x86_64_    (4 CPU)

04:21:56 PM   UID      TGID       TID    %usr %system  %guest    %CPU   CPU  Command
04:21:56 PM     0         1         -    0.02    0.01    0.00    0.03     0  systemd
04:21:56 PM     0         -         1    0.02    0.01    0.00    0.03     0  |__systemd
04:21:56 PM     0         2         -    0.00    0.00    0.00    0.00     0  kthreadd
04:21:56 PM     0         -         2    0.00    0.00    0.00    0.00     0  |__kthreadd
...&#x7701;&#x7565;&#x540E;&#x7EED;&#x5185;&#x5BB9;...

04:21:56 PM   UID      TGID       TID   cswch/s nvcswch/s  Command
04:21:56 PM     0         1         -      1.75      0.00  systemd
04:21:56 PM     0         -         1      1.75      0.00  |__systemd
04:21:56 PM     0         2         -      0.01      0.00  kthreadd
04:21:56 PM     0         -         2      0.01      0.00  |__kthreadd
04:21:56 PM     0         3         -      2.53      0.00  ksoftirqd/0
...&#x7701;&#x7565;&#x540E;&#x7EED;&#x5185;&#x5BB9;...
</code></pre>
<h2 id="&#x4ECE;procinterrupts&#x8BFB;&#x53D6;&#x4E2D;&#x65AD;&#x72B6;&#x6001;">&#x4ECE;/proc/interrupts&#x8BFB;&#x53D6;&#x4E2D;&#x65AD;&#x72B6;&#x6001;</h2>
<p><code>watch -d cat /proc/interrupts</code>&#x7528;&#x53EF;&#x4EE5;&#x663E;&#x793A;&#x4E2D;&#x65AD;&#x7684;&#x53D8;&#x5316;&#x60C5;&#x51B5;&#x3002;</p>
<pre><code class="lang-bash">Every 2.0s: cat /proc/interrupts                                                                                                                                                    Tue Dec  4 16:29:25 2018

           CPU0       CPU1     CPU2       CPU3
  0:        153          0          0          0   IO-APIC-edge      timer
  1:         10          0          0          0   IO-APIC-edge      i8042
  6:          3          0          0          0   IO-APIC-edge      floppy
  8:          0          0          0          0   IO-APIC-edge      rtc0
  9:          0          0          0          0   IO-APIC-fasteoi   acpi
 10:          0          0          0          0   IO-APIC-fasteoi   virtio0
 11:         31          0          3          0   IO-APIC-fasteoi   uhci_hcd:usb1
 12:         15          0          0          0   IO-APIC-edge      i8042
 14:          0          0          0          0   IO-APIC-edge      ata_piix
 15:          0          0          0          0   IO-APIC-edge      ata_piix
 24:          0          0          0          0   PCI-MSI-edge      virtio3-config
 25:       6234          0     120283     272843   PCI-MSI-edge      virtio3-req.0
 26:          0          0          0          0   PCI-MSI-edge      virtio1-config
 27:         99  176029503  172147021          0   PCI-MSI-edge      virtio1-input.0
 28:         24       2721        497       4165   PCI-MSI-edge      virtio1-output.0
 29:          0          0          0          0   PCI-MSI-edge      virtio2-config
 30:         19          0          0          0   PCI-MSI-edge      virtio2-virtqueues
 31:          0          0          0          0   PCI-MSI-edge      virtio4-config
 32:     131111          0          0          0   PCI-MSI-edge      virtio4-req.0
NMI:          0          0          0          0   Non-maskable interrupts
LOC:   64284244   70653905   70450086   65741168   Local timer interrupts
SPU:          0          0          0          0   Spurious interrupts
PMI:          0          0          0          0   Performance monitoring interrupts
IWI:    1242971    1424513    1360783    1296367   IRQ work interrupts
RTR:          0          0          0          0   APIC ICR <span class="hljs-built_in">read</span> retries
RES:   33708963   29562936   30300354   32946303   Rescheduling interrupts
CAL:  131150935   64213698   67023823  133615842   Function call interrupts
TLB:     519133     541110     531432     522850   TLB shootdowns
TRM:          0          0          0          0   Thermal event interrupts
THR:          0          0          0          0   Threshold APIC interrupts
DFR:          0          0          0          0   Deferred Error APIC interrupts
MCE:          0          0          0          0   Machine check exceptions
MCP:       2001       2001     2001       2001   Machine check polls
ERR:          0
MIS:          0
PIN:          0          0          0          0   Posted-interrupt notification event
PIW:          0          0          0          0   Posted-interrupt wakeup event
</code></pre>
<p><code>Rescheduling interrupts</code>&#x662F;&#x91CD;&#x8C03;&#x5EA6;&#x4E2D;&#x65AD;&#xFF0C;&#x7528;&#x6765;&#x5524;&#x9192;&#x7A7A;&#x95F2;&#x7684;CPU&#x6267;&#x884C;&#x65B0;&#x7684;&#x4EFB;&#x52A1;&#x3002;</p>
<script type="text/javascript">var className='atoc';</script>
                                
<div>
<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- Page_Bottom -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-8176866190626448"
     data-ad-slot="7945072540"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
</div>


                                
                                </section>
                            
                        </div>
                    </div>
                
            </div>

            
                
                <a href="03-cpu.html" class="navigation navigation-prev " aria-label="Previous page: 理解CPU">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="03-cpu-2.html" class="navigation navigation-next " aria-label="Next page: CPU使用率">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"上下文切换","level":"1.2.3.1","depth":3,"next":{"title":"CPU使用率","level":"1.2.3.2","depth":3,"path":"chapter1/03-cpu-2.md","ref":"chapter1/03-cpu-2.md","articles":[]},"previous":{"title":"理解CPU","level":"1.2.3","depth":2,"path":"chapter1/03-cpu.md","ref":"chapter1/03-cpu.md","articles":[{"title":"上下文切换","level":"1.2.3.1","depth":3,"path":"chapter1/03-cpu-1.md","ref":"chapter1/03-cpu-1.md","articles":[]},{"title":"CPU使用率","level":"1.2.3.2","depth":3,"path":"chapter1/03-cpu-2.md","ref":"chapter1/03-cpu-2.md","articles":[]}]},"dir":"ltr"},"config":{"plugins":["atoc","livereload"],"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"pluginsConfig":{"atoc":{"addClass":true,"className":"atoc"},"livereload":{},"highlight":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"theme":"default","pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"variables":{},"title":"Linux实用手册","gitbook":"*"},"file":{"path":"chapter1/03-cpu-1.md","mtime":"2019-01-21T04:06:36.406Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2019-01-21T08:12:43.939Z"},"basePath":"..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-atoc/atoc.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-livereload/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

