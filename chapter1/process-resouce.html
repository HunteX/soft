
<!DOCTYPE HTML>
<html lang="zh-hans" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>进程占用的资源 · GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        <meta name="author" content="lijiaocn@foxmail.com">
        
        
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-atoc/atoc.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="../chapter3/01-filesystem.html" />
    
    
    <link rel="prev" href="02-process-2.html" />
    

        
<!--Google ads -->
<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<script>
  (adsbygoogle = window.adsbygoogle || []).push({
    google_ad_client: "ca-pub-8176866190626448",
    enable_page_level_ads: true
  });
</script>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-105389858-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-105389858-1');
</script>

<!--百度统计-->
<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?8f59ea10145df28da8932c8743ec1d60";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>

<!--百度收录-->
<script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>


    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="输入并搜索" />
</div>

            
                
<div style="text-align:center">
    <h2><a href="https://www.lijiaocn.com" style="color:#afa790">www.lijiaocn.com</a></h2>
</div>

<div style="text-align:center">
<!-- 250x250 -->
<ins class="adsbygoogle"
     style="display:inline-block;width:250px;height:250px"
     data-ad-client="ca-pub-8176866190626448"
     data-ad-slot="9490087185"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
</div>

<div style="text-align:center">
    <h4><a href="https://www.lijiaocn.com/linux" style="color:#afa790">《Linux使用手册》</a></h4>
    <h4><a href="https://www.lijiaocn.com/programming" style="color:#afa790">《编程速查手册》</a></h4>
    <h4><a href="https://www.lijiaocn.com/nginx" style="color:#afa790">《Nginx & Openresty》</a></h4>
</div>


                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                    Linux实用手册说明
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="./">
            
                <a href="./">
            
                    
                    Linux性能优化与问题诊断
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1" data-path="01-concept.html">
            
                <a href="01-concept.html">
            
                    
                    认知框架
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2" data-path="kernel.html">
            
                <a href="kernel.html">
            
                    
                    理解内核
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.2.1" data-path="dynamic-trace.html">
            
                <a href="dynamic-trace.html">
            
                    
                    动态追踪
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.2.3" data-path="03-cpu.html">
            
                <a href="03-cpu.html">
            
                    
                    理解CPU
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.3.1" data-path="02-process-3.html">
            
                <a href="02-process-3.html">
            
                    
                    CPU的工作状态
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.3.2" data-path="03-cpu-1.html">
            
                <a href="03-cpu-1.html">
            
                    
                    CPU上下文切换
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.3.3" data-path="cpu-usage-analysis.html">
            
                <a href="cpu-usage-analysis.html">
            
                    
                    CPU的使用情况
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.2.4" data-path="memory.html">
            
                <a href="memory.html">
            
                    
                    理解内存
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.4.1" data-path="memory-manage.html">
            
                <a href="memory-manage.html">
            
                    
                    内存管理
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.4.2" data-path="memory-cache.html">
            
                <a href="memory-cache.html">
            
                    
                    内存缓存
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.4.3" data-path="memory-stat.html">
            
                <a href="memory-stat.html">
            
                    
                    内存状态
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.2.5" data-path="interrupt.html">
            
                <a href="interrupt.html">
            
                    
                    理解中断
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.5.1" data-path="sys-interrupt.html">
            
                <a href="sys-interrupt.html">
            
                    
                    系统中断
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.2.6" data-path="02-process.html">
            
                <a href="02-process.html">
            
                    
                    理解进程
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.6.1" data-path="02-process-1.html">
            
                <a href="02-process-1.html">
            
                    
                    进程的分类
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.6.2" data-path="02-process-2.html">
            
                <a href="02-process-2.html">
            
                    
                    进程的状态
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="1.2.6.3" data-path="process-resouce.html">
            
                <a href="process-resouce.html">
            
                    
                    进程占用的资源
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.2.7" data-path="../chapter3/01-filesystem.html">
            
                <a href="../chapter3/01-filesystem.html">
            
                    
                    理解文件系统
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.7.1" data-path="../chapter3/vfs.html">
            
                <a href="../chapter3/vfs.html">
            
                    
                    VFS
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.7.2" data-path="../chapter3/disk.html">
            
                <a href="../chapter3/disk.html">
            
                    
                    磁盘
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.7.3" data-path="../chapter3/filesystem-stat.html">
            
                <a href="../chapter3/filesystem-stat.html">
            
                    
                    文件系统状态
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.7.4" data-path="../chapter3/02-io.html">
            
                <a href="../chapter3/02-io.html">
            
                    
                    I/O操作分类
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.7.5" data-path="../chapter3/process_sys_io.html">
            
                <a href="../chapter3/process_sys_io.html">
            
                    
                    系统I/O状态
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.2.8" data-path="network.html">
            
                <a href="network.html">
            
                    
                    理解网络
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.8.1" data-path="network-metrics.html">
            
                <a href="network-metrics.html">
            
                    
                    性能指标与检测
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.8.2" data-path="network-nic-stat.html">
            
                <a href="network-nic-stat.html">
            
                    
                    网卡状态
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.8.3" data-path="network-stat.html">
            
                <a href="network-stat.html">
            
                    
                    连接/协议栈状态
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.8.4" data-path="network-netfilter.html">
            
                <a href="network-netfilter.html">
            
                    
                    连接跟踪netfilter
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.8.5" data-path="network-trace-pkt.html">
            
                <a href="network-trace-pkt.html">
            
                    
                    报文跟踪
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.8.6" data-path="network-dns-trace.html">
            
                <a href="network-dns-trace.html">
            
                    
                    DNS解析追踪
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.8.7" data-path="netio-high-performance.html">
            
                <a href="netio-high-performance.html">
            
                    
                    高性能网络IO
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.2.9" data-path="04-tool.html">
            
                <a href="04-tool.html">
            
                    
                    分析工具
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.9.1" data-path="04-flame-graphs.html">
            
                <a href="04-flame-graphs.html">
            
                    
                    火焰图介绍
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.9.1.1" data-path="04-flame-graphs-cpu.html">
            
                <a href="04-flame-graphs-cpu.html">
            
                    
                    CPU火焰图
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.9.1.2" data-path="04-flame-graphs-memory.html">
            
                <a href="04-flame-graphs-memory.html">
            
                    
                    内存火焰图
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.9.1.3" data-path="04-flame-graphs-off-cpu.html">
            
                <a href="04-flame-graphs-off-cpu.html">
            
                    
                    Off-CPU火焰图
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.9.1.4" data-path="04-flame-graphs-hot-code.html">
            
                <a href="04-flame-graphs-hot-code.html">
            
                    
                    冷热火焰图
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.9.1.5" data-path="04-flame-graphs-differential.html">
            
                <a href="04-flame-graphs-differential.html">
            
                    
                    差异火焰图
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.9.1.6" data-path="04-flame-generate.html">
            
                <a href="04-flame-generate.html">
            
                    
                    火焰图生成
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.2.9.2" data-path="04-bcc-tools.html">
            
                <a href="04-bcc-tools.html">
            
                    
                    BCC系列工具
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.2.10" data-path="cpu-usage-high.html">
            
                <a href="cpu-usage-high.html">
            
                    
                    案例: CPU使用率很高
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="../chapter3/">
            
                <a href="../chapter3/">
            
                    
                    Linux系统知识
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="../chapter4/">
            
                <a href="../chapter4/">
            
                    
                    Linux虚拟化技术
            
                </a>
            

            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.lijiaocn.com" target="blank" class="gitbook-link">
            本书由 lijiaocn 提供
        </a>
    </li>
</ul>


                </nav>
                
<br>
<!--div style="text-align:center"-->
<!-- Summary_Bottom -->
<!--ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-8176866190626448"
     data-ad-slot="2156601384"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
</div-->


            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >进程占用的资源</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                
<!-- Page_Top -->
<!--div>
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-8176866190626448"
     data-ad-slot="5702052586"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
</div-->


                                <!-- toc -->
<ul>
<li><a href="#linux&#x67E5;&#x770B;&#x6307;&#x5B9A;&#x8FDB;&#x7A0B;&#x5360;&#x7528;&#x7684;&#x8D44;&#x6E90;">Linux&#x67E5;&#x770B;&#x6307;&#x5B9A;&#x8FDB;&#x7A0B;&#x5360;&#x7528;&#x7684;&#x8D44;&#x6E90;</a><ul>
<li><a href="#pidstat&#x67E5;&#x770B;&#x8FDB;&#x7A0B;&#x7684;cpu&#x4F7F;&#x7528;&#x7387;">pidstat&#x67E5;&#x770B;&#x8FDB;&#x7A0B;&#x7684;CPU&#x4F7F;&#x7528;&#x7387;</a></li>
<li><a href="#pidstat&#x67E5;&#x770B;&#x8FDB;&#x7A0B;&#x7684;io&#x60C5;&#x51B5;">pidstat&#x67E5;&#x770B;&#x8FDB;&#x7A0B;&#x7684;IO&#x60C5;&#x51B5;</a></li>
<li><a href="#pidstat&#x67E5;&#x770B;&#x8FDB;&#x7A0B;&#x7684;&#x5207;&#x6362;&#x60C5;&#x51B5;">pidstat&#x67E5;&#x770B;&#x8FDB;&#x7A0B;&#x7684;&#x5207;&#x6362;&#x60C5;&#x51B5;</a></li>
<li><a href="#lsof&#x67E5;&#x770B;&#x8FDB;&#x7A0B;&#x6253;&#x5F00;&#x7684;&#x6587;&#x4EF6;">lsof&#x67E5;&#x770B;&#x8FDB;&#x7A0B;&#x6253;&#x5F00;&#x7684;&#x6587;&#x4EF6;</a></li>
<li><a href="#strace&#x67E5;&#x770B;&#x8FDB;&#x7A0B;&#x53D1;&#x8D77;&#x7684;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;">strace&#x67E5;&#x770B;&#x8FDB;&#x7A0B;&#x53D1;&#x8D77;&#x7684;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;</a></li>
</ul>
</li>
</ul>
<!-- tocstop -->
<h1 id="linux&#x67E5;&#x770B;&#x6307;&#x5B9A;&#x8FDB;&#x7A0B;&#x5360;&#x7528;&#x7684;&#x8D44;&#x6E90;">Linux&#x67E5;&#x770B;&#x6307;&#x5B9A;&#x8FDB;&#x7A0B;&#x5360;&#x7528;&#x7684;&#x8D44;&#x6E90;</h1>
<p>&#x67E5;&#x770B;&#x6307;&#x5B9A;&#x8FDB;&#x7A0B;&#x5360;&#x7528;&#x7684;&#x8D44;&#x6E90;&#x3002;</p>
<h2 id="pidstat&#x67E5;&#x770B;&#x8FDB;&#x7A0B;&#x7684;cpu&#x4F7F;&#x7528;&#x7387;">pidstat&#x67E5;&#x770B;&#x8FDB;&#x7A0B;&#x7684;CPU&#x4F7F;&#x7528;&#x7387;</h2>
<p><code>pidstat</code>&#x547D;&#x4EE4;&#x53EF;&#x4EE5;&#x663E;&#x793A;&#x6BCF;&#x4E2A;&#x8FDB;&#x7A0B;&#x7684;&#x5728;&#x4E0D;&#x540C;CPU&#x72B6;&#x6001;&#x4E2D;&#x8017;&#x8D39;&#x7684;&#x65F6;&#x95F4;&#x7684;&#x767E;&#x5206;&#x6BD4;(1&#xFF0C;&#x6BCF;&#x79D2;&#x663E;&#x793A;&#x4E00;&#x6B21;&#xFF1B;-p&#xFF0C;&#x6307;&#x5B9A;&#x8FDB;&#x7A0B;&#xFF0C;&#x5982;&#x679C;&#x4E0D;&#x6307;&#x5B9A;&#xFF0C;&#x663E;&#x793A;&#x6240;&#x6709;&#x8FDB;&#x7A0B;)&#xFF1A;</p>
<pre><code class="lang-bash">$ pidstat  1 -p  27936
Linux 3.10.0-693.11.6.el7.x86_64 (10.10.64.58)     12/04/2018     _x86_64_    (4 CPU)

05:00:59 PM   UID       PID    %usr %system  %guest    %CPU   CPU  Command
05:01:00 PM    99     27936    0.00    0.00    0.00    0.00     0  openresty
05:01:01 PM    99     27936    0.00    0.00    0.00    0.00     0  openresty
05:01:02 PM    99     27936    0.00    0.00    0.00    0.00     0  openresty
</code></pre>
<h2 id="pidstat&#x67E5;&#x770B;&#x8FDB;&#x7A0B;&#x7684;io&#x60C5;&#x51B5;">pidstat&#x67E5;&#x770B;&#x8FDB;&#x7A0B;&#x7684;IO&#x60C5;&#x51B5;</h2>
<p>pidstat&#xFF0C;<code>-d</code>&#x8868;&#x793A;&#x5C55;&#x793A;IO&#x4FE1;&#x606F;&#xFF0C;1&#x8868;&#x793A;&#x6BCF;&#x79D2;&#x8F93;&#x51FA;&#x4E00;&#x6B21;&#xFF0C;&#x4F7F;&#x7528;-p&#x6307;&#x5B9A;&#x8FDB;&#x7A0B;&#x53F7;&#xFF0C;&#x4E0B;&#x9762;&#x95F4;&#x9694; 1 &#x79D2;&#x8F93;&#x51FA; 3 &#x7EC4;&#x6570;&#x636E;&#xFF1A;</p>
<pre><code class="lang-sh">$ pidstat <span class="hljs-_">-d</span> -p 4344 1 3
06:38:50      UID       PID   kB_rd/s   kB_wr/s kB_ccwr/s iodelay  Command
06:38:51        0      4344      0.00      0.00      0.00       0  app
06:38:52        0      4344      0.00      0.00      0.00       0  app
06:38:53        0      4344      0.00      0.00      0.00       0  app
</code></pre>
<h2 id="pidstat&#x67E5;&#x770B;&#x8FDB;&#x7A0B;&#x7684;&#x5207;&#x6362;&#x60C5;&#x51B5;">pidstat&#x67E5;&#x770B;&#x8FDB;&#x7A0B;&#x7684;&#x5207;&#x6362;&#x60C5;&#x51B5;</h2>
<p><code>pidstat -w -p &#x8FDB;&#x7A0B;&#x53F7;</code>&#x53EF;&#x4EE5;&#x663E;&#x793A;&#x6307;&#x5B9A;&#x8FDB;&#x7A0B;&#x7684;&#x4E0A;&#x4E0B;&#x6587;&#x5207;&#x6362;&#x60C5;&#x51B5;&#xFF1A;</p>
<pre><code class="lang-bash">$ pidstat -w 2 -p 426
Linux 4.20.12-1.el7.elrepo.x86_64 (10.10.64.58)     04/29/2019     _x86_64_    (4 CPU)

03:01:12 PM   UID       PID   cswch/s nvcswch/s  Command
03:01:14 PM    99       426      2.99      0.00  openresty
03:01:16 PM    99       426      2.50      0.00  openresty
03:01:18 PM    99       426      3.00      0.00  openresty
03:01:20 PM    99       426      2.00      0.00  openresty
</code></pre>
<p><code>-w</code>&#x53C2;&#x6570;&#x7684;&#x4F5C;&#x7528;&#x662F;&#x663E;&#x793A;&#x8FDB;&#x7A0B;&#x5207;&#x6362;&#x72B6;&#x6001;&#xFF0C;&#x6BCF;&#x4E00;&#x5217;&#x7684;&#x542B;&#x4E49;&#x5982;&#x4E0B;&#xFF08;&#x53EF;&#x4EE5;&#x5728;<code>man pidstat</code>&#x4E2D;&#x627E;&#x5230;&#xFF09;&#xFF1A;</p>
<pre><code> -w     Report task switching activity (kernels 2.6.23 and later only).  
        The following values may be displayed:
  UID
         The real user identification number of the task being monitored.

  USER
         The name of the real user owning the task being monitored.

  PID
         The identification number of the task being monitored.

  cswch/s
         Total number of voluntary context switches the task made per second.  
         A voluntary context switch occurs when a task blocks because it requires 
         a resource that is unavailable.

  nvcswch/s
         Total number of non voluntary context switches the task made per second.  
         A involuntary context switch takes place when a task executes for the duration 
         of its  time  slice  and then is forced to relinquish the processor.

  Command
         The command name of the task.
</code></pre><p>&#x9700;&#x8981;&#x6CE8;&#x610F;&#x81EA;&#x613F;&#x5207;&#x6362;&#xFF08;cswch/s&#xFF0C;voluntary context switches&#xFF09;&#x548C;&#x975E;&#x81EA;&#x613F;&#x5207;&#x6362;&#xFF08;nvcswch/s&#xFF0C;non voluntary context switches&#xFF09;&#x7684;&#x533A;&#x522B;&#x3002;&#x524D;&#x8005;&#x662F;&#x56E0;&#x4E3A;&#x9700;&#x8981;&#x7684;&#x8D44;&#x6E90;&#x6CA1;&#x6709;&#x51C6;&#x5907;&#x597D;&#xFF0C;&#x4E3B;&#x52A8;&#x8BA9;&#x51FA;CPU&#x53D1;&#x751F;&#x7684;&#x5207;&#x6362;&#xFF0C;&#x540E;&#x8005;&#x662F;&#x8FDB;&#x7A0B;&#x5206;&#x914D;&#x7684;&#x65F6;&#x95F4;&#x7247;&#x5DF2;&#x7ECF;&#x7528;&#x5B8C;&#xFF0C;&#x88AB;&#x8C03;&#x5EA6;&#x5668;&#x5F3A;&#x5236;&#x5207;&#x6362;&#x3002;</p>
<p>pidstats -w&#x663E;&#x793A;&#x7684;&#x662F;&#x8FDB;&#x7A0B;&#x7684;&#x72B6;&#x6001;&#xFF0C;&#x5982;&#x679C;&#x8981;&#x5C06;&#x7EBF;&#x7A0B;&#x4E00;&#x5E76;&#x663E;&#x793A;&#x51FA;&#x6765;&#xFF0C;&#x9700;&#x8981;&#x518D;&#x52A0;&#x4E00;&#x4E2A;-t&#x53C2;&#x6570;&#xFF1A;</p>
<pre><code class="lang-bash">$ pidstat -wt
Average:      UID      TGID       TID   cswch/s nvcswch/s  Command
Average:        0         3         -      3.92      0.00  ksoftirqd/0
Average:        0         -         3      3.92      0.00  |__ksoftirqd/0
Average:        0         9         -     45.59      0.00  rcu_<span class="hljs-built_in">sched</span>
Average:        0         -         9     45.59      0.00  |__rcu_<span class="hljs-built_in">sched</span>
Average:        0        13         -      1.96      0.00  ksoftirqd/1
Average:        0         -        13      1.96      0.00  |__ksoftirqd/1
Average:        0        17         -      0.49      0.00  migration/2
</code></pre>
<p>&#x53E6;&#x5916;pidstat&#x8FD8;&#x6709;&#x4E00;&#x4E2A;<code>-u</code>&#x53C2;&#x6570;&#xFF0C;&#x53EF;&#x4EE5;&#x4E00;&#x5E76;&#x8F93;&#x51FA;&#x8FDB;&#x7A0B;&#x548C;&#x7EBF;&#x7A0B;&#xFF08;&#x52A0;-t&#xFF09;&#x7684;CPU&#x4F7F;&#x7528;&#x60C5;&#x51B5;&#xFF1A;</p>
<pre><code class="lang-bash">[root@10.10.64.58 ~]<span class="hljs-comment">#  pidstat -wt -u</span>
Linux 3.10.0-693.11.6.el7.x86_64 (10.10.64.58)     12/04/2018     _x86_64_    (4 CPU)

04:21:56 PM   UID      TGID       TID    %usr %system  %guest    %CPU   CPU  Command
04:21:56 PM     0         1         -    0.02    0.01    0.00    0.03     0  systemd
04:21:56 PM     0         -         1    0.02    0.01    0.00    0.03     0  |__systemd
04:21:56 PM     0         2         -    0.00    0.00    0.00    0.00     0  kthreadd
04:21:56 PM     0         -         2    0.00    0.00    0.00    0.00     0  |__kthreadd

04:21:56 PM   UID      TGID       TID   cswch/s nvcswch/s  Command
04:21:56 PM     0         1         -      1.75      0.00  systemd
04:21:56 PM     0         -         1      1.75      0.00  |__systemd
04:21:56 PM     0         2         -      0.01      0.00  kthreadd
04:21:56 PM     0         -         2      0.01      0.00  |__kthreadd
04:21:56 PM     0         3         -      2.53      0.00  ksoftirqd/0
</code></pre>
<h2 id="lsof&#x67E5;&#x770B;&#x8FDB;&#x7A0B;&#x6253;&#x5F00;&#x7684;&#x6587;&#x4EF6;">lsof&#x67E5;&#x770B;&#x8FDB;&#x7A0B;&#x6253;&#x5F00;&#x7684;&#x6587;&#x4EF6;</h2>
<p>lsof&#x67E5;&#x770B;&#x8FDB;&#x7A0B;&#x6253;&#x5F00;&#x7684;&#x6587;&#x4EF6;&#xFF0C;-p&#x6307;&#x5B9A;&#x8FDB;&#x7A0B;&#x53F7;&#xFF0C;&#x6CE8;&#x610F;&#x5FC5;&#x987B;&#x662F;&#x8FDB;&#x7A0B;&#x53F7;&#xFF0C;&#x4E0D;&#x80FD;&#x662F;&#x7EBF;&#x7A0B;&#x53F7;&#xFF1A;</p>
<pre><code class="lang-sh">$ lsof -p 18940 
COMMAND   PID USER   FD   TYPE DEVICE  SIZE/OFF    NODE NAME 
python  18940 root  cwd    DIR   0,50      4096 1549389 / 
python  18940 root  rtd    DIR   0,50      4096 1549389 / 
&#x2026; 
python  18940 root    2u   CHR  136,0       0t0       3 /dev/pts/0 
python  18940 root    3w   REG    8,1 117944320     303 /tmp/logtest.txt
</code></pre>
<h2 id="strace&#x67E5;&#x770B;&#x8FDB;&#x7A0B;&#x53D1;&#x8D77;&#x7684;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;">strace&#x67E5;&#x770B;&#x8FDB;&#x7A0B;&#x53D1;&#x8D77;&#x7684;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;</h2>
<p>strace&#x8DDF;&#x8E2A;&#x8FDB;&#x7A0B;&#x7684;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#xFF0C;-f &#x8868;&#x793A;&#x8DDF;&#x8E2A;&#x5B50;&#x8FDB;&#x7A0B;&#x548C;&#x5B50;&#x7EBF;&#x7A0B;&#xFF0C;-T &#x8868;&#x793A;&#x663E;&#x793A;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x7684;&#x65F6;&#x957F;&#xFF0C;-tt &#x8868;&#x793A;&#x663E;&#x793A;&#x8DDF;&#x8E2A;&#x65F6;&#x95F4;&#xFF1A;</p>
<pre><code class="lang-sh">$ strace <span class="hljs-_">-f</span> -T -tt -p 9085
[pid  9085] 14:20:16.826131 epoll_pwait(5, [{EPOLLIN, {u32=8, u64=8}}], 10128, 65, NULL, 8) = 1 &lt;0.000055&gt;
[pid  9085] 14:20:16.826301 <span class="hljs-built_in">read</span>(8, <span class="hljs-string">&quot;*2\r\n<span class="hljs-variable">$3</span>\r\nGET\r\n<span class="hljs-variable">$41</span>\r\nuuid:5b2e76cc-&quot;</span>..., 16384) = 61 &lt;0.000071&gt;
[pid  9085] 14:20:16.826477 <span class="hljs-built_in">read</span>(3, 0x7fff366a5747, 1) = -1 EAGAIN (Resource temporarily unavailable) &lt;0.000063&gt;
[pid  9085] 14:20:16.826645 write(8, <span class="hljs-string">&quot;<span class="hljs-variable">$3</span>\r\nbad\r\n&quot;</span>, 9) = 9 &lt;0.000173&gt;
[pid  9085] 14:20:16.826907 epoll_pwait(5, [{EPOLLIN, {u32=8, u64=8}}], 10128, 65, NULL, 8) = 1 &lt;0.000032&gt;
[pid  9085] 14:20:16.827030 <span class="hljs-built_in">read</span>(8, <span class="hljs-string">&quot;*2\r\n<span class="hljs-variable">$3</span>\r\nGET\r\n<span class="hljs-variable">$41</span>\r\nuuid:55862ada-&quot;</span>..., 16384) = 61 &lt;0.000044&gt;
[pid  9085] 14:20:16.827149 <span class="hljs-built_in">read</span>(3, 0x7fff366a5747, 1) = -1 EAGAIN (Resource temporarily unavailable) &lt;0.000043&gt;
[pid  9085] 14:20:16.827285 write(8, <span class="hljs-string">&quot;<span class="hljs-variable">$3</span>\r\nbad\r\n&quot;</span>, 9) = 9 &lt;0.000141&gt;
[pid  9085] 14:20:16.827514 epoll_pwait(5, [{EPOLLIN, {u32=8, u64=8}}], 10128, 64, NULL, 8) = 1 &lt;0.000049&gt;
[pid  9085] 14:20:16.827641 <span class="hljs-built_in">read</span>(8, <span class="hljs-string">&quot;*2\r\n<span class="hljs-variable">$3</span>\r\nGET\r\n<span class="hljs-variable">$41</span>\r\nuuid:53522908-&quot;</span>..., 16384) = 61 &lt;0.000043&gt;
[pid  9085] 14:20:16.827784 <span class="hljs-built_in">read</span>(3, 0x7fff366a5747, 1) = -1 EAGAIN (Resource temporarily unavailable) &lt;0.000034&gt;
[pid  9085] 14:20:16.827945 write(8, <span class="hljs-string">&quot;<span class="hljs-variable">$4</span>\r\ngood\r\n&quot;</span>, 10) = 10 &lt;0.000288&gt;
[pid  9085] 14:20:16.828339 epoll_pwait(5, [{EPOLLIN, {u32=8, u64=8}}], 10128, 63, NULL, 8) = 1 &lt;0.000057&gt;
[pid  9085] 14:20:16.828486 <span class="hljs-built_in">read</span>(8, <span class="hljs-string">&quot;*3\r\n<span class="hljs-variable">$4</span>\r\nSADD\r\n<span class="hljs-variable">$4</span>\r\ngood\r\n<span class="hljs-variable">$36</span>\r\n535&quot;</span>..., 16384) = 67 &lt;0.000040&gt;
[pid  9085] 14:20:16.828623 <span class="hljs-built_in">read</span>(3, 0x7fff366a5747, 1) = -1 EAGAIN (Resource temporarily unavailable) &lt;0.000052&gt;
[pid  9085] 14:20:16.828760 write(7, <span class="hljs-string">&quot;*3\r\n<span class="hljs-variable">$4</span>\r\nSADD\r\n<span class="hljs-variable">$4</span>\r\ngood\r\n<span class="hljs-variable">$36</span>\r\n535&quot;</span>..., 67) = 67 &lt;0.000060&gt;
[pid  9085] 14:20:16.828970 fdatasync(7) = 0 &lt;0.005415&gt;
[pid  9085] 14:20:16.834493 write(8, <span class="hljs-string">&quot;:1\r\n&quot;</span>, 4) = 4 &lt;0.000250&gt;
</code></pre>
<script type="text/javascript">var className='atoc';</script>
                                
<div>
<!-- 匹配内容 -->
<div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
<ins class="adsbygoogle"
     style="display:block"
     data-ad-format="autorelaxed"
     data-ad-client="ca-pub-8176866190626448"
     data-ad-slot="6443696990"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
</div>

<!--div-->
<!-- Page_Bottom -->
<!--ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-8176866190626448"
     data-ad-slot="7945072540"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
</div-->


                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="02-process-2.html" class="navigation navigation-prev " aria-label="Previous page: 进程的状态">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="../chapter3/01-filesystem.html" class="navigation navigation-next " aria-label="Next page: 理解文件系统">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"进程占用的资源","level":"1.2.6.3","depth":3,"next":{"title":"理解文件系统","level":"1.2.7","depth":2,"path":"chapter3/01-filesystem.md","ref":"chapter3/01-filesystem.md","articles":[{"title":"VFS","level":"1.2.7.1","depth":3,"path":"chapter3/vfs.md","ref":"chapter3/vfs.md","articles":[]},{"title":"磁盘","level":"1.2.7.2","depth":3,"path":"chapter3/disk.md","ref":"chapter3/disk.md","articles":[]},{"title":"文件系统状态","level":"1.2.7.3","depth":3,"path":"chapter3/filesystem-stat.md","ref":"chapter3/filesystem-stat.md","articles":[]},{"title":"I/O操作分类","level":"1.2.7.4","depth":3,"path":"chapter3/02-io.md","ref":"chapter3/02-io.md","articles":[]},{"title":"系统I/O状态","level":"1.2.7.5","depth":3,"path":"chapter3/process_sys_io.md","ref":"chapter3/process_sys_io.md","articles":[]}]},"previous":{"title":"进程的状态","level":"1.2.6.2","depth":3,"path":"chapter1/02-process-2.md","ref":"chapter1/02-process-2.md","articles":[]},"dir":"ltr"},"config":{"plugins":[{"name":"theme-lijiaocn","version":"git+https://github.com/lijiaocn/theme-lijiaocn.git"},"atoc"],"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"pluginsConfig":{"atoc":{"addClass":true,"className":"atoc"},"highlight":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-lijiaocn":{"showLevel":false,"styles":{"ebook":"styles/ebook.css","epub":"styles/epub.css","mobi":"styles/mobi.css","pdf":"styles/pdf.css","print":"styles/print.css","website":"styles/website.css"}},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"theme":"default","author":"lijiaocn@foxmail.com","pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"isbn":"","variables":{},"language":"zh-hans","gitbook":">=3.0.0"},"file":{"path":"chapter1/process-resouce.md","mtime":"2019-04-29T07:26:48.384Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2019-04-29T07:42:59.422Z"},"basePath":"..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-atoc/atoc.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

